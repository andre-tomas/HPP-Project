#include<stdio.h>
#include<stdlib.h>
#include<math.h>


const double PI = 3.14159265359;





int main() {

  double X = 1;
  double T = 1;

  double dx = 0.05;
  double dt = 0.00001;
  double r = dt/(dx*dx);

  int Nx = X/dx;
  int Nt = T/dt;


  double* U = (double*)malloc(Nx*sizeof(double));

  double temp1;
  double x;
  for (int i = 0; i <= Nx; i++) {
    x = (double)i*dx;
    temp1 = sin(PI*x)/(PI*PI);
    //printf("%f\n",temp1);
    U[i] = temp1;
  }
  

  double* temp = (double*)malloc(Nx*sizeof(double));
  
  for (int i = 0; i <= Nt; i++) {
    U[0] = 0;
    U[Nx] = 0;
    temp = U; 
    for (int j = 0; j <= Nx; j++) {   
      U[j] = (1-2*r)*temp[j] + r*(temp[j-1] + temp[j+1]);
    }
    //printf("Current t: %f\n",(double)i*dt );
  }

  for (int i = 0; i <= Nx; i++) {
    printf("U(1,%f) = %f\n",(double)i*dx,U[i]);
  }
  

}

